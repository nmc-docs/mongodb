"use strict";(self.webpackChunknextjs=self.webpackChunknextjs||[]).push([[694],{7690:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>d,default:()=>u,frontMatter:()=>c,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"crud/element-query-operator","title":"Element Query Operators","description":"1. Gi\u1edbi thi\u1ec7u","source":"@site/docs/crud/element-query-operator.md","sourceDirName":"crud","slug":"/crud/element-query-operator","permalink":"/mongodb/crud/element-query-operator","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10},"sidebar":"tutorialSidebar","previous":{"title":"To\xe1n t\u1eed v\u1edbi m\u1ea3ng","permalink":"/mongodb/crud/array-operators"},"next":{"title":"Evaluation Query Operators","permalink":"/mongodb/crud/evaluation-query-operators"}}');var s=t(4848),r=t(8453);const c={sidebar_position:10},d="Element Query Operators",l={},a=[{value:"1. Gi\u1edbi thi\u1ec7u",id:"1-gi\u1edbi-thi\u1ec7u",level:2},{value:"2. C\xe1c Element Query Operators",id:"2-c\xe1c-element-query-operators",level:2},{value:"<code>$exists</code> - Ki\u1ec3m tra s\u1ef1 t\u1ed3n t\u1ea1i c\u1ee7a tr\u01b0\u1eddng",id:"exists---ki\u1ec3m-tra-s\u1ef1-t\u1ed3n-t\u1ea1i-c\u1ee7a-tr\u01b0\u1eddng",level:3},{value:"<code>$type</code> - Ki\u1ec3m tra ki\u1ec3u d\u1eef li\u1ec7u c\u1ee7a tr\u01b0\u1eddng",id:"type---ki\u1ec3m-tra-ki\u1ec3u-d\u1eef-li\u1ec7u-c\u1ee7a-tr\u01b0\u1eddng",level:3},{value:"K\u1ebft h\u1ee3p c\xe1c Element Operators",id:"k\u1ebft-h\u1ee3p-c\xe1c-element-operators",level:2},{value:"K\u1ebft h\u1ee3p <code>$exists</code> v\xe0 <code>$type</code>",id:"k\u1ebft-h\u1ee3p-exists-v\xe0-type",level:3},{value:"K\u1ebft h\u1ee3p v\u1edbi c\xe1c to\xe1n t\u1eed kh\xe1c",id:"k\u1ebft-h\u1ee3p-v\u1edbi-c\xe1c-to\xe1n-t\u1eed-kh\xe1c",level:3},{value:"V\xed d\u1ee5 th\u1ef1c t\u1ebf chi ti\u1ebft",id:"v\xed-d\u1ee5-th\u1ef1c-t\u1ebf-chi-ti\u1ebft",level:2},{value:"Data validation v\xe0 cleanup",id:"data-validation-v\xe0-cleanup",level:3},{value:"Data quality reports",id:"data-quality-reports",level:3}];function o(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"element-query-operators",children:"Element Query Operators"})}),"\n",(0,s.jsx)(e.h2,{id:"1-gi\u1edbi-thi\u1ec7u",children:"1. Gi\u1edbi thi\u1ec7u"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"Element Query Operators"})," l\xe0 c\xe1c to\xe1n t\u1eed truy v\u1ea5n cho ph\xe9p ta thao t\xe1c v\u1edbi c\xe1c documents d\u1ef1a tr\xean ",(0,s.jsx)(e.strong,{children:"s\u1ef1 t\u1ed3n t\u1ea1i, ki\u1ec3u d\u1eef li\u1ec7u v\xe0 c\u1ea5u tr\xfac c\u1ee7a c\xe1c tr\u01b0\u1eddng (fields)"})," . C\xe1c to\xe1n t\u1eed n\xe0y gi\xfap x\xe1c \u0111\u1ecbnh xem m\u1ed9t tr\u01b0\u1eddng c\xf3 t\u1ed3n t\u1ea1i kh\xf4ng, c\xf3 ph\u1ea3i l\xe0 ki\u1ec3u d\u1eef li\u1ec7u c\u1ee5 th\u1ec3 n\xe0o kh\xf4ng, v\xe0 c\xf3 ph\xf9 h\u1ee3p v\u1edbi c\xe1c \u0111i\u1ec1u ki\u1ec7n v\u1ec1 c\u1ea5u tr\xfac kh\xf4ng."]}),"\n",(0,s.jsx)(e.h2,{id:"2-c\xe1c-element-query-operators",children:"2. C\xe1c Element Query Operators"}),"\n",(0,s.jsxs)(e.h3,{id:"exists---ki\u1ec3m-tra-s\u1ef1-t\u1ed3n-t\u1ea1i-c\u1ee7a-tr\u01b0\u1eddng",children:[(0,s.jsx)(e.code,{children:"$exists"})," - Ki\u1ec3m tra s\u1ef1 t\u1ed3n t\u1ea1i c\u1ee7a tr\u01b0\u1eddng"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["To\xe1n t\u1eed ",(0,s.jsx)(e.code,{children:"$exists"})," ki\u1ec3m tra xem m\u1ed9t tr\u01b0\u1eddng c\xf3 t\u1ed3n t\u1ea1i trong document hay kh\xf4ng."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"C\xfa ph\xe1p:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"{ field: { $exists: <boolean> } }\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"V\xed d\u1ee5:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'// T\xecm c\xe1c documents c\xf3 tr\u01b0\u1eddng "email"\ndb.users.find({ email: { $exists: true } });\n\n// T\xecm c\xe1c documents KH\xd4NG c\xf3 tr\u01b0\u1eddng "phone"\ndb.users.find({ phone: { $exists: false } });\n\n// T\xecm products c\xf3 tr\u01b0\u1eddng "discountPrice"\ndb.products.find({ discountPrice: { $exists: true } });\n\n// T\xecm users kh\xf4ng c\xf3 tr\u01b0\u1eddng "middleName"\ndb.users.find({ middleName: { $exists: false } });\n'})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"V\xed d\u1ee5 th\u1ef1c t\u1ebf:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'// T\xecm users \u0111\xe3 cung c\u1ea5p s\u1ed1 \u0111i\u1ec7n tho\u1ea1i\ndb.users.find({\n  "contact.phone": { $exists: true },\n});\n\n// T\xecm orders ch\u01b0a c\xf3 ng\xe0y ho\xe0n th\xe0nh\ndb.orders.find({\n  completedAt: { $exists: false },\n});\n\n// K\u1ebft h\u1ee3p v\u1edbi c\xe1c \u0111i\u1ec1u ki\u1ec7n kh\xe1c\ndb.users.find({\n  email: { $exists: true },\n  age: { $gte: 18 },\n  status: "active",\n});\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.h3,{id:"type---ki\u1ec3m-tra-ki\u1ec3u-d\u1eef-li\u1ec7u-c\u1ee7a-tr\u01b0\u1eddng",children:[(0,s.jsx)(e.code,{children:"$type"})," - Ki\u1ec3m tra ki\u1ec3u d\u1eef li\u1ec7u c\u1ee7a tr\u01b0\u1eddng"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["To\xe1n t\u1eed ",(0,s.jsx)(e.code,{children:"$type"})," ki\u1ec3m tra ki\u1ec3u d\u1eef li\u1ec7u BSON c\u1ee7a m\u1ed9t tr\u01b0\u1eddng."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"C\xfa ph\xe1p:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:"{ field: { $type: <BSONType> } }\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"C\xe1c ki\u1ec3u BSON ph\u1ed5 bi\u1ebfn:"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:'"double"'})," - S\u1ed1 th\u1ef1c"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:'"string"'})," - Chu\u1ed7i"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:'"object"'})," - Object"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:'"array"'})," - M\u1ea3ng"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:'"binData"'})," - Binary data"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:'"objectId"'})," - ObjectId"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:'"bool"'})," - Boolean"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:'"date"'})," - Date"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:'"null"'})," - Null"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:'"int"'})," - S\u1ed1 nguy\xean 32-bit"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:'"long"'})," - S\u1ed1 nguy\xean 64-bit"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:'"decimal"'})," - Decimal128"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"V\xed d\u1ee5:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'// T\xecm documents c\xf3 tr\u01b0\u1eddng "age" l\xe0 ki\u1ec3u s\u1ed1\ndb.users.find({ age: { $type: "number" } });\n\n// T\xecm documents c\xf3 tr\u01b0\u1eddng "price" l\xe0 ki\u1ec3u s\u1ed1 nguy\xean\ndb.products.find({ price: { $type: ["int", "long"] } });\n\n// T\xecm documents c\xf3 tr\u01b0\u1eddng "tags" l\xe0 m\u1ea3ng\ndb.posts.find({ tags: { $type: "array" } });\n\n// T\xecm documents c\xf3 tr\u01b0\u1eddng "createdAt" l\xe0 ki\u1ec3u Date\ndb.logs.find({ createdAt: { $type: "date" } });\n'})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"V\xed d\u1ee5 chi ti\u1ebft v\u1edbi nhi\u1ec1u ki\u1ec3u:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'// T\xecm users c\xf3 phone l\xe0 chu\u1ed7i (thay v\xec s\u1ed1)\ndb.users.find({\n  phone: { $type: "string" },\n});\n\n// T\xecm products c\xf3 price l\xe0 s\u1ed1 th\u1ef1c\ndb.products.find({\n  price: { $type: "double" },\n});\n\n// T\xecm documents c\xf3 tr\u01b0\u1eddng null\ndb.collection.find({\n  optionalField: { $type: "null" },\n});\n\n// T\xecm v\u1edbi nhi\u1ec1u ki\u1ec3u d\u1eef li\u1ec7u\ndb.collection.find({\n  field: { $type: ["string", "object", "array"] },\n});\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"k\u1ebft-h\u1ee3p-c\xe1c-element-operators",children:"K\u1ebft h\u1ee3p c\xe1c Element Operators"}),"\n",(0,s.jsxs)(e.h3,{id:"k\u1ebft-h\u1ee3p-exists-v\xe0-type",children:["K\u1ebft h\u1ee3p ",(0,s.jsx)(e.code,{children:"$exists"})," v\xe0 ",(0,s.jsx)(e.code,{children:"$type"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'// T\xecm documents c\xf3 tr\u01b0\u1eddng "age" t\u1ed3n t\u1ea1i V\xc0 l\xe0 ki\u1ec3u s\u1ed1\ndb.users.find({\n  age: {\n    $exists: true,\n    $type: "number",\n  },\n});\n\n// T\xecm documents c\xf3 tr\u01b0\u1eddng "email" t\u1ed3n t\u1ea1i nh\u01b0ng KH\xd4NG ph\u1ea3i ki\u1ec3u string\ndb.users.find({\n  email: {\n    $exists: true,\n    $type: { $ne: "string" },\n  },\n});\n'})}),"\n",(0,s.jsx)(e.h3,{id:"k\u1ebft-h\u1ee3p-v\u1edbi-c\xe1c-to\xe1n-t\u1eed-kh\xe1c",children:"K\u1ebft h\u1ee3p v\u1edbi c\xe1c to\xe1n t\u1eed kh\xe1c"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'// T\xecm users c\xf3 email t\u1ed3n t\u1ea1i, l\xe0 string v\xe0 kh\xf4ng r\u1ed7ng\ndb.users.find({\n  email: {\n    $exists: true,\n    $type: "string",\n    $ne: "",\n    $regex: /.+@.+\\..+/, // regex ki\u1ec3m tra \u0111\u1ecbnh d\u1ea1ng email\n  },\n});\n\n// T\xecm products c\xf3 price t\u1ed3n t\u1ea1i, l\xe0 number v\xe0 > 0\ndb.products.find({\n  price: {\n    $exists: true,\n    $type: "number",\n    $gt: 0,\n  },\n});\n'})}),"\n",(0,s.jsx)(e.h2,{id:"v\xed-d\u1ee5-th\u1ef1c-t\u1ebf-chi-ti\u1ebft",children:"V\xed d\u1ee5 th\u1ef1c t\u1ebf chi ti\u1ebft"}),"\n",(0,s.jsx)(e.h3,{id:"data-validation-v\xe0-cleanup",children:"Data validation v\xe0 cleanup"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'// T\xecm documents c\xf3 v\u1ea5n \u0111\u1ec1 v\u1ec1 ki\u1ec3u d\u1eef li\u1ec7u\nconst problematicDocuments = db.users.find({\n  $or: [\n    {\n      // age t\u1ed3n t\u1ea1i nh\u01b0ng kh\xf4ng ph\u1ea3i s\u1ed1\n      age: {\n        $exists: true,\n        $type: { $ne: "number" },\n      },\n    },\n    {\n      // email t\u1ed3n t\u1ea1i nh\u01b0ng kh\xf4ng ph\u1ea3i string\n      email: {\n        $exists: true,\n        $type: { $ne: "string" },\n      },\n    },\n    {\n      // createdDate t\u1ed3n t\u1ea1i nh\u01b0ng kh\xf4ng ph\u1ea3i Date\n      createdDate: {\n        $exists: true,\n        $type: { $ne: "date" },\n      },\n    },\n  ],\n});\n\n// Fix d\u1eef li\u1ec7u\nproblematicDocuments.forEach(function (doc) {\n  if (doc.age && typeof doc.age !== "number") {\n    db.users.updateOne(\n      { _id: doc._id },\n      { $set: { age: parseInt(doc.age) || 0 } }\n    );\n  }\n});\n'})}),"\n",(0,s.jsx)(e.h3,{id:"data-quality-reports",children:"Data quality reports"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'// B\xe1o c\xe1o ch\u1ea5t l\u01b0\u1ee3ng d\u1eef li\u1ec7u\nfunction generateDataQualityReport() {\n  const totalUsers = db.users.countDocuments();\n\n  const usersWithEmail = db.users.countDocuments({\n    email: { $exists: true },\n  });\n\n  const usersWithValidEmail = db.users.countDocuments({\n    email: {\n      $exists: true,\n      $type: "string",\n      $regex: /.+@.+\\..+/,\n    },\n  });\n\n  const usersWithPhone = db.users.countDocuments({\n    "contact.phone": { $exists: true },\n  });\n\n  const usersWithValidAge = db.users.countDocuments({\n    age: {\n      $exists: true,\n      $type: "number",\n      $gte: 0,\n      $lte: 120,\n    },\n  });\n\n  return {\n    totalUsers,\n    emailCoverage: `${((usersWithEmail / totalUsers) * 100).toFixed(2)}%`,\n    validEmailRate: `${((usersWithValidEmail / usersWithEmail) * 100).toFixed(\n      2\n    )}%`,\n    phoneCoverage: `${((usersWithPhone / totalUsers) * 100).toFixed(2)}%`,\n    validAgeRate: `${((usersWithValidAge / totalUsers) * 100).toFixed(2)}%`,\n  };\n}\n\nconst report = generateDataQualityReport();\nconsole.log("Data Quality Report:", report);\n'})})]})}function u(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(o,{...n})}):o(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>c,x:()=>d});var i=t(6540);const s={},r=i.createContext(s);function c(n){const e=i.useContext(r);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:c(n.components),i.createElement(r.Provider,{value:e},n.children)}}}]);