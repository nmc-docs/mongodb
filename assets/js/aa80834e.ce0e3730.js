"use strict";(self.webpackChunknextjs=self.webpackChunknextjs||[]).push([[231],{1117:(n,c,e)=>{e.r(c),e.d(c,{assets:()=>h,contentTitle:()=>s,default:()=>a,frontMatter:()=>o,metadata:()=>i,toc:()=>r});const i=JSON.parse('{"id":"crud/collection-operation","title":"C\xe1c thao t\xe1c v\u1edbi collection","description":"T\u1ea1o collection","source":"@site/docs/crud/collection-operation.md","sourceDirName":"crud","slug":"/crud/collection-operation","permalink":"/mongodb/crud/collection-operation","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"C\xe1c thao t\xe1c v\u1edbi Database","permalink":"/mongodb/crud/database-operation"},"next":{"title":"Ch\xe8n document","permalink":"/mongodb/crud/insert-document"}}');var t=e(4848),l=e(8453);const o={sidebar_position:2},s="C\xe1c thao t\xe1c v\u1edbi collection",h={},r=[{value:"T\u1ea1o collection",id:"t\u1ea1o-collection",level:2},{value:"Schema validation",id:"schema-validation",level:3},{value:"Xem t\u1ea5t c\u1ea3 c\xe1c collections hi\u1ec7n c\xf3 trong database",id:"xem-t\u1ea5t-c\u1ea3-c\xe1c-collections-hi\u1ec7n-c\xf3-trong-database",level:2},{value:"\u0110\u1ed5i t\xean collection",id:"\u0111\u1ed5i-t\xean-collection",level:2},{value:"X\xf3a collection",id:"x\xf3a-collection",level:2}];function d(n){const c={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.header,{children:(0,t.jsx)(c.h1,{id:"c\xe1c-thao-t\xe1c-v\u1edbi-collection",children:"C\xe1c thao t\xe1c v\u1edbi collection"})}),"\n",(0,t.jsx)(c.h2,{id:"t\u1ea1o-collection",children:"T\u1ea1o collection"}),"\n",(0,t.jsx)(c.admonition,{type:"info",children:(0,t.jsxs)(c.ul,{children:["\n",(0,t.jsxs)(c.li,{children:["\u0110\u1ec3 t\u1ea1o 1 collection, ta d\xf9ng:","\n",(0,t.jsx)(c.pre,{children:(0,t.jsx)(c.code,{className:"language-js",children:"db.createCollection(COLLECTION_NAME);\n"})}),"\n"]}),"\n"]})}),"\n",(0,t.jsx)(c.h3,{id:"schema-validation",children:"Schema validation"}),"\n",(0,t.jsxs)(c.ul,{children:["\n",(0,t.jsxs)(c.li,{children:["\n",(0,t.jsxs)(c.p,{children:[(0,t.jsx)(c.strong,{children:"Schema Validation"})," (X\xe1c th\u1ef1c Schema) l\xe0 m\u1ed9t t\xednh n\u0103ng c\u1ee7a MongoDB cho ph\xe9p ta ",(0,t.jsx)(c.strong,{children:"\xe1p d\u1ee5ng c\xe1c quy t\u1eafc c\u1ee5 th\u1ec3 l\xean c\u1ea5u tr\xfac c\u1ee7a c\xe1c document trong m\u1ed9t collection"}),". N\xf3i c\xe1ch kh\xe1c, n\xf3 cho ph\xe9p ta ki\u1ec3m so\xe1t:"]}),"\n",(0,t.jsxs)(c.ul,{children:["\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.strong,{children:"Tr\u01b0\u1eddng (Field) n\xe0o l\xe0 b\u1eaft bu\u1ed9c"})," ph\u1ea3i c\xf3."]}),"\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.strong,{children:"Ki\u1ec3u d\u1eef li\u1ec7u (Data Type)"})," c\u1ee7a m\u1ed7i tr\u01b0\u1eddng (string, number, array, date...)."]}),"\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.strong,{children:"\u0110i\u1ec1u ki\u1ec7n (Rules)"})," cho gi\xe1 tr\u1ecb c\u1ee7a tr\u01b0\u1eddng (v\xed d\u1ee5: tu\u1ed5i ph\u1ea3i l\u1edbn h\u01a1n 0, email ph\u1ea3i \u0111\xfang \u0111\u1ecbnh d\u1ea1ng, gi\xe1 tr\u1ecb ph\u1ea3i n\u1eb1m trong m\u1ed9t danh s\xe1ch cho tr\u01b0\u1edbc)."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(c.li,{children:["\n",(0,t.jsxs)(c.p,{children:["M\u1ee5c \u0111\xedch ch\xednh l\xe0 ",(0,t.jsx)(c.strong,{children:"\u0111\u1ea3m b\u1ea3o t\xednh to\xe0n v\u1eb9n v\xe0 nh\u1ea5t qu\xe1n c\u1ee7a d\u1eef li\u1ec7u"}),' ngay t\u1ea1i c\u01a1 s\u1edf d\u1eef li\u1ec7u, ng\u0103n ch\u1eb7n vi\u1ec7c ch\xe8n c\xe1c document "b\u1ea9n" ho\u1eb7c kh\xf4ng \u0111\xfang chu\u1ea9n v\xe0o collection.']}),"\n"]}),"\n",(0,t.jsxs)(c.li,{children:["\n",(0,t.jsx)(c.p,{children:"M\u1eb7c d\xf9 MongoDB l\xe0 m\u1ed9t c\u01a1 s\u1edf d\u1eef li\u1ec7u NoSQL linh ho\u1ea1t (schemaless) - ngh\u0129a l\xe0 c\xe1c document trong c\xf9ng m\u1ed9t collection kh\xf4ng c\u1ea7n ph\u1ea3i c\xf3 c\xf9ng c\u1ea5u tr\xfac - nh\u01b0ng trong th\u1ef1c t\u1ebf, h\u1ea7u h\u1ebft c\xe1c \u1ee9ng d\u1ee5ng \u0111\u1ec1u ho\u1ea1t \u0111\u1ed9ng t\u1ed1t h\u01a1n khi d\u1eef li\u1ec7u tu\xe2n theo m\u1ed9t c\u1ea5u tr\xfac nh\u1ea5t \u0111\u1ecbnh."}),"\n"]}),"\n",(0,t.jsxs)(c.li,{children:["\n",(0,t.jsxs)(c.p,{children:["Schema Validation ho\u1ea1t \u0111\u1ed9ng d\u1ef1a tr\xean ",(0,t.jsx)(c.strong,{children:"JSON Schema"})," - m\u1ed9t ti\xeau chu\u1ea9n m\u1edf \u0111\u1ec3 m\xf4 t\u1ea3 c\u1ea5u tr\xfac c\u1ee7a d\u1eef li\u1ec7u JSON."]}),"\n"]}),"\n",(0,t.jsxs)(c.li,{children:["\n",(0,t.jsxs)(c.p,{children:["Khi ta thi\u1ebft l\u1eadp c\xe1c quy t\u1eafc validation cho m\u1ed9t collection, MongoDB s\u1ebd ki\u1ec3m tra m\u1ecdi thao t\xe1c ",(0,t.jsx)(c.strong,{children:"insert"})," (ch\xe8n m\u1edbi) v\xe0 ",(0,t.jsx)(c.strong,{children:"update"})," (c\u1eadp nh\u1eadt). N\u1ebfu m\u1ed9t thao t\xe1c n\xe0o \u0111\xf3 vi ph\u1ea1m c\xe1c quy t\u1eafc, n\xf3 s\u1ebd b\u1ecb t\u1eeb ch\u1ed1i v\xe0 tr\u1ea3 v\u1ec1 l\u1ed7i."]}),"\n"]}),"\n",(0,t.jsxs)(c.li,{children:["\n",(0,t.jsx)(c.p,{children:"Ta c\xf3 th\u1ec3 c\u1ea5u h\xecnh 2 ch\u1ebf \u0111\u1ed9 cho validation:"}),"\n",(0,t.jsxs)(c.ul,{children:["\n",(0,t.jsxs)(c.li,{children:[(0,t.jsxs)(c.strong,{children:[(0,t.jsx)(c.code,{children:"validationLevel"}),":"]})," X\xe1c \u0111\u1ecbnh xem validation \u0111\u01b0\u1ee3c \xe1p d\u1ee5ng cho document n\xe0o.","\n",(0,t.jsxs)(c.ul,{children:["\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.code,{children:"strict"})," (M\u1eb7c \u0111\u1ecbnh): \xc1p d\u1ee5ng quy t\u1eafc cho M\u1eccI thao t\xe1c insert v\xe0 update."]}),"\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.code,{children:"moderate"}),": Ch\u1ec9 \xe1p d\u1ee5ng cho c\xe1c document \u0111\xe3 h\u1ee3p l\u1ec7 s\u1eb5n v\xe0 c\xe1c document m\u1edbi \u0111\u01b0\u1ee3c insert/update. B\u1ecf qua c\xe1c document \u0111\xe3 t\u1ed3n t\u1ea1i m\xe0 kh\xf4ng h\u1ee3p l\u1ec7 t\u1eeb tr\u01b0\u1edbc."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(c.li,{children:[(0,t.jsxs)(c.strong,{children:[(0,t.jsx)(c.code,{children:"validationAction"}),":"]})," X\xe1c \u0111\u1ecbnh MongoDB ph\u1ea3n \u1ee9ng th\u1ebf n\xe0o khi c\xf3 l\u1ed7i validation.","\n",(0,t.jsxs)(c.ul,{children:["\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.code,{children:"error"})," (M\u1eb7c \u0111\u1ecbnh): T\u1eeb ch\u1ed1i thao t\xe1c v\xe0 tr\u1ea3 v\u1ec1 l\u1ed7i."]}),"\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.code,{children:"warn"}),": Ghi l\u1ea1i l\u1ed7i v\xe0o log, nh\u01b0ng V\u1eaaN CHO PH\xc9P thao t\xe1c \u0111\xf3 th\u1ef1c hi\u1ec7n. (H\u1eefu \xedch cho giai \u0111o\u1ea1n chuy\u1ec3n \u0111\u1ed5i)."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(c.li,{children:["\n",(0,t.jsxs)(c.p,{children:["Gi\u1ea3 s\u1eed ch\xfang ta c\xf3 m\u1ed9t collection ",(0,t.jsx)(c.code,{children:"users"})," v\xe0 mu\u1ed1n c\xe1c document ph\u1ea3i tu\xe2n theo c\xe1c quy t\u1eafc sau:"]}),"\n",(0,t.jsxs)(c.ul,{children:["\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.code,{children:"name"}),": B\u1eaft bu\u1ed9c, ki\u1ec3u string."]}),"\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.code,{children:"email"}),": B\u1eaft bu\u1ed9c, ki\u1ec3u string v\xe0 ph\u1ea3i kh\u1edbp v\u1edbi \u0111\u1ecbnh d\u1ea1ng email."]}),"\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.code,{children:"age"}),": Kh\xf4ng b\u1eaft bu\u1ed9c, nh\u01b0ng n\u1ebfu c\xf3 th\xec ph\u1ea3i l\xe0 s\u1ed1 nguy\xean l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng 0."]}),"\n",(0,t.jsxs)(c.li,{children:[(0,t.jsx)(c.code,{children:"status"}),": B\u1eaft bu\u1ed9c, gi\xe1 tr\u1ecb ph\u1ea3i n\u1eb1m trong m\u1ea3ng ",(0,t.jsx)(c.code,{children:'["active", "inactive"]'}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(c.p,{children:(0,t.jsx)(c.strong,{children:"1. T\u1ea1o Validation Schema khi t\u1ea1o Collection m\u1edbi"})}),"\n",(0,t.jsx)(c.pre,{children:(0,t.jsx)(c.code,{className:"language-js",children:'db.createCollection("users", {\n  validator: {\n    $jsonSchema: {\n      bsonType: "object",\n      required: ["name", "email", "status"], // C\xe1c tr\u01b0\u1eddng b\u1eaft bu\u1ed9c\n      properties: {\n        // \u0110\u1ecbnh ngh\u0129a c\xe1c thu\u1ed9c t\xednh\n        name: {\n          bsonType: "string",\n          description: "T\xean ph\u1ea3i l\xe0 m\u1ed9t chu\u1ed7i v\xe0 l\xe0 b\u1eaft bu\u1ed9c",\n        },\n        email: {\n          bsonType: "string",\n          pattern: "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\\\.[a-zA-Z]{2,}$", // Regex cho email\n          description: "Email ph\u1ea3i l\xe0 m\u1ed9t chu\u1ed7i v\xe0 theo \u0111\u1ecbnh d\u1ea1ng email h\u1ee3p l\u1ec7",\n        },\n        age: {\n          bsonType: "int",\n          minimum: 0,\n          description: "Tu\u1ed5i ph\u1ea3i l\xe0 s\u1ed1 nguy\xean kh\xf4ng \xe2m",\n        },\n        status: {\n          enum: ["active", "inactive"], // Gi\xe1 tr\u1ecb ph\u1ea3i n\u1eb1m trong danh s\xe1ch\n          description: "Tr\u1ea1ng th\xe1i ph\u1ea3i l\xe0 \'active\' ho\u1eb7c \'inactive\'",\n        },\n      },\n    },\n  },\n});\n'})}),"\n",(0,t.jsx)(c.p,{children:(0,t.jsx)(c.strong,{children:"2. Th\xeam Validation Schema v\xe0o m\u1ed9t Collection \u0111\xe3 t\u1ed3n t\u1ea1i"})}),"\n",(0,t.jsxs)(c.ul,{children:["\n",(0,t.jsxs)(c.li,{children:["S\u1eed d\u1ee5ng l\u1ec7nh ",(0,t.jsx)(c.code,{children:"collMod"})," (collection modification):"]}),"\n"]}),"\n",(0,t.jsx)(c.pre,{children:(0,t.jsx)(c.code,{className:"language-js",children:'db.runCommand({\n  collMod: "users",\n  validator: {\n    $jsonSchema: {\n      // ... (Schema gi\u1ed1ng nh\u01b0 \u1edf tr\xean)\n    },\n  },\n});\n'})}),"\n",(0,t.jsx)(c.h2,{id:"xem-t\u1ea5t-c\u1ea3-c\xe1c-collections-hi\u1ec7n-c\xf3-trong-database",children:"Xem t\u1ea5t c\u1ea3 c\xe1c collections hi\u1ec7n c\xf3 trong database"}),"\n",(0,t.jsx)(c.pre,{children:(0,t.jsx)(c.code,{className:"language-bash",children:"use database_name\nshow collections\n"})}),"\n",(0,t.jsx)(c.h2,{id:"\u0111\u1ed5i-t\xean-collection",children:"\u0110\u1ed5i t\xean collection"}),"\n",(0,t.jsx)(c.pre,{children:(0,t.jsx)(c.code,{className:"language-js",children:'db.old_name.renameCollection("New name");\n'})}),"\n",(0,t.jsx)(c.h2,{id:"x\xf3a-collection",children:"X\xf3a collection"}),"\n",(0,t.jsx)(c.pre,{children:(0,t.jsx)(c.code,{className:"language-js",children:"db.collection_name.drop();\n"})})]})}function a(n={}){const{wrapper:c}={...(0,l.R)(),...n.components};return c?(0,t.jsx)(c,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},8453:(n,c,e)=>{e.d(c,{R:()=>o,x:()=>s});var i=e(6540);const t={},l=i.createContext(t);function o(n){const c=i.useContext(l);return i.useMemo(function(){return"function"==typeof n?n(c):{...c,...n}},[c,n])}function s(n){let c;return c=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:o(n.components),i.createElement(l.Provider,{value:c},n.children)}}}]);